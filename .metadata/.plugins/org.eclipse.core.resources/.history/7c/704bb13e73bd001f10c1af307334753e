package Client;

import java.sql.*;
import java.util.Scanner;

public class Client {
	public static void LoginCustomer() throws SQLException {
        boolean success = false;
        System.out.println("Welcome to the Console Login Page\n");
        Scanner scanner = new Scanner(System.in);
        while(success == false)
        {
        	System.out.print("Enter your email: ");
            String username = scanner.nextLine();

            System.out.print("Enter your password: ");
            String password = scanner.nextLine();

            String jdbcURL = "jdbc:mysql://mysql-svalora.alwaysdata.net:3306/svalora_wineshop";
            String usernameDb = "svalora_wineshop";
            String passwordDb = "Wine-shop1!";

            try (Connection con = DriverManager.getConnection(jdbcURL, usernameDb, passwordDb);) {
                // Query per recuperare i dati dell'utente dal database
                String selectQuery = "SELECT Email, Psw FROM Customer WHERE Email = ? AND Psw = ?";

                try (PreparedStatement preparedStatement = con.prepareStatement(selectQuery)) {
                    preparedStatement.setString(1, username);
                    preparedStatement.setString(2, password);
                    ResultSet resultSet = preparedStatement.executeQuery();

                    if (resultSet.next()) {
                        String validUsername = resultSet.getString("Email");
                        String validPassword = resultSet.getString("Psw");

                        if (password.equals(validPassword) && username.equals(validUsername) ) {
                            System.out.println("Login successful!");
                            success = true;
                        } else {
                            System.out.println("Login failed. Please try again.");
                        }
                    } else {
                        System.out.println("Username not found. Please try again.");
                    }
                }
                con.close();
            } catch (SQLException e) {
                e.printStackTrace();
            }
            // Chiudi lo scanner quando hai finito
            
        }
        scanner.close();
    }
	
	public static void main(String args[])
    {  
        System.out.println("Benvenuto");
    }

}
